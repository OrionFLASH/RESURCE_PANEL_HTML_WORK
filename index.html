<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–†–µ—Å—É—Ä—Å–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–±–æ—á–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º –∏ —Å–µ—Ä–≤–∏—Å–∞–º">
    <meta name="keywords" content="—Ä–µ—Å—É—Ä—Å—ã, –ø–∞–Ω–µ–ª—å, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Å–µ—Ä–≤–∏—Å—ã">
    <meta name="author" content="Sberbank">
    
    <!-- Open Graph –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π -->
    <meta property="og:title" content="–†–µ—Å—É—Ä—Å–Ω–∞—è –ø–∞–Ω–µ–ª—å">
    <meta property="og:description" content="–†–µ—Å—É—Ä—Å–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–±–æ—á–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º">
    <meta property="og:type" content="website">
    
    <title>–†–µ—Å—É—Ä—Å–Ω–∞—è –ø–∞–Ω–µ–ª—å</title>
    
<style>
:root {
    /* Liquid Glass iOS 26 - –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
    --glass-bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 50%, #d4e0ed 100%);
    --glass-white: rgba(255, 255, 255, 0.7);
    --glass-white-light: rgba(255, 255, 255, 0.6);
    --glass-white-border: rgba(255, 255, 255, 0.5);
    --glass-white-border-light: rgba(255, 255, 255, 0.4);
    --glass-text: #1d1d1f;
    --glass-text-secondary: #6e6e73;
    --glass-blue: #007AFF;
    --glass-blue-light: rgba(0, 122, 255, 0.15);
    --glass-blue-border: rgba(0, 122, 255, 0.3);
    --glass-purple: #5856D6;
    --glass-header-bg: linear-gradient(135deg, rgba(0, 122, 255, 0.15) 0%, rgba(88, 86, 214, 0.15) 100%);
    --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.04), inset 0 1px 0 rgba(255, 255, 255, 0.9);
    --glass-shadow-hover: 0 12px 40px rgba(0, 0, 0, 0.12), 0 4px 12px rgba(0, 0, 0, 0.06), inset 0 1px 0 rgba(255, 255, 255, 0.9);
    --glass-card-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), inset 0 1px 0 rgba(255, 255, 255, 0.8);
    --glass-card-shadow-hover: 0 4px 16px rgba(0, 122, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.9);
    --glass-red: #FF3B30;
    --glass-red-hover: #FF2D20;
    --glass-green: #34C759;
    --glass-green-hover: #30D158;
}

body {
    background: var(--glass-bg-gradient);
    color: var(--glass-text);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    margin: 0;
    min-height: 100vh;
}
.container {
    width: 100%;
    max-width: 2300px;
    margin: 0 auto;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
}
.ios-title {
    font-weight: 700;
    color: var(--glass-text);
    margin-bottom: 20px;
    font-size: 32px;
    background: linear-gradient(135deg, var(--glass-blue) 0%, var(--glass-purple) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    user-select: none;
    text-align: center;
    letter-spacing: -0.5px;
    flex-shrink: 0;
}
.top-actions {
    width: 100%;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 20px;
    flex-shrink: 0;
}
.top-actions.stacked {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
    margin-bottom: 16px;
}
.groups-viewport {
    flex: 1 1 auto;
    min-height: 0;
    min-width: 0;
    height: 100%;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}
.groups-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-auto-rows: 1fr;
    gap: 20px;
    width: 100%;
    min-height: 0;
    height: 100%;
    align-items: stretch;
}
.ios-group {
    display: flex;
    flex-direction: column;
    background: var(--glass-white);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border-radius: 24px;
    border: 1px solid var(--glass-white-border);
    box-shadow: var(--glass-shadow);
    overflow: hidden;
    min-width: 0;
    min-height: 0;
    height: 100%;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.ios-group:hover {
    transform: translateY(-2px);
    box-shadow: var(--glass-shadow-hover);
}
.ios-group-header {
    font-weight: 600;
    font-size: 18px;
    color: var(--glass-text);
    padding: 16px 20px;
    background: var(--glass-header-bg);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    text-align: center;
    user-select: none;
    flex-shrink: 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    letter-spacing: -0.3px;
}
.ios-group-cards {
    display: flex;
    flex-direction: column;
    flex: 1 1 auto;
    background: transparent;
    min-height: 0;
    gap: 8px;
    padding: 12px;
    overflow-y: auto;
    overflow-x: hidden;
}
/* –°–∫—Ä–æ–ª–ª–±–∞—Ä –≤ —Å—Ç–∏–ª–µ iOS */
.ios-group-cards::-webkit-scrollbar {
    width: 6px;
}
.ios-group-cards::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 10px;
}
.ios-group-cards::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
}
.ios-group-cards::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
}
.ios-card {
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--glass-white-light);
    backdrop-filter: blur(10px) saturate(150%);
    -webkit-backdrop-filter: blur(10px) saturate(150%);
    border: 1px solid var(--glass-white-border-light);
    border-radius: 16px;
    margin: 0;
    font-size: 15px; /* –£–≤–µ–ª–∏—á–µ–Ω –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
    min-height: 52px; /* –£–≤–µ–ª–∏—á–µ–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è */
    max-height: 78px; /* –£–≤–µ–ª–∏—á–µ–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è 3 —Å—Ç—Ä–æ–∫ —Ç–µ–∫—Å—Ç–∞ */
    padding: 10px 14px; /* –ù–µ–º–Ω–æ–≥–æ —É–º–µ–Ω—å—à–µ–Ω padding –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –º–µ—Å—Ç–∞ –ø–æ–¥ —Ç–µ–∫—Å—Ç */
    font-weight: 500;
    box-shadow: var(--glass-card-shadow);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    text-decoration: none;
    color: var(--glass-text);
    cursor: pointer;
    position: relative;
    outline: none;
    flex-shrink: 0;
    text-align: center;
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
    line-height: 1.5; /* –£–≤–µ–ª–∏—á–µ–Ω line-height –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
}
.ios-card:hover, .ios-card:focus {
    background: var(--glass-blue-light);
    border-color: var(--glass-blue-border);
    transform: scale(1.02);
    box-shadow: var(--glass-card-shadow-hover);
    color: var(--glass-text);
}
.ios-card:active {
    transform: scale(0.98);
}
.ios-card-title {
    color: inherit;
    font-weight: 500;
    font-size: inherit;
    text-align: center;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1 1 auto;
    line-height: 1.5; /* –£–≤–µ–ª–∏—á–µ–Ω line-height –¥–ª—è –ª—É—á—à–µ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è */
    word-wrap: break-word;
    overflow-wrap: break-word;
    width: 100%; /* –ó–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å—é —à–∏—Ä–∏–Ω—É –∫–Ω–æ–ø–∫–∏ */
}
.ios-card-status {
    margin-left: 13px;
    width: 8.5px;
    height: 8.5px;
    border-radius: 50%;
    font-size: 13px !important;
    background: var(--sber-light-green);
    border: 1px solid var(--sber-white);
    box-shadow: 0 0.5px 2px rgba(33,160,56,0.13);
}

.ios-card-status {
    display: none !important;
}
.ios-card-status.unavailable {
    background: var(--sber-red);
}

.ios-card-title.unavailable {
    color: var(--glass-text-secondary) !important;
    opacity: 0.6;
    transition: color .18s, opacity .18s;
}


/* ==== –ú–æ–¥–∞–ª–∫–∏ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ) - Liquid Glass —Å—Ç–∏–ª—å ==== */
.modal {
    display: none;
    position: fixed;
    z-index: 1050;
    left: 0; top: 0; width: 100vw; height: 100vh;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    align-items: center; justify-content: center;
    transition: background .22s;
}
.modal.show { display: flex; }
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
.modal-content {
    background: var(--glass-white);
    backdrop-filter: blur(30px) saturate(180%);
    -webkit-backdrop-filter: blur(30px) saturate(180%);
    border-radius: 28px;
    box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.15),
        0 8px 24px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
    border: 1px solid var(--glass-white-border);
    padding: 36px 36px 28px 36px;
    max-width: 800px;
    min-width: 500px;
    width: 94vw;
    max-height: 90vh;
    overflow-y: auto;
    animation: modalIn .23s cubic-bezier(.68,-0.55,.27,1.55);
    color: var(--glass-text);
    box-sizing: border-box;
}
/* –°–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
.modal-content::-webkit-scrollbar {
    width: 8px;
}
.modal-content::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 10px;
}
.modal-content::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
}
.modal-content::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
}
/* –î–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª–µ–π –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
.modal-content.modal-large {
    max-width: 1000px;
    min-width: 600px;
    width: 96vw;
    padding: 40px 40px 30px 40px;
}
/* –î–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
.modal-content.modal-small {
    max-width: 600px;
    min-width: 400px;
    width: 90vw;
    padding: 32px 32px 24px 32px;
}
@keyframes modalIn {
    from { opacity: 0; transform: scale(.98) translateY(40px);}
    to   { opacity: 1; transform: scale(1)   translateY(0);}
}
.modal-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--glass-text);
    margin-bottom: 20px;
    letter-spacing: -0.5px;
    background: linear-gradient(135deg, var(--glass-blue) 0%, var(--glass-purple) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
}
.modal-buttons {
    display: flex;
    gap: 12px;
    margin-top: 24px;
    flex-wrap: wrap;
    justify-content: flex-end;
}
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∫–Ω–æ–ø–æ–∫: –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–ª–µ–≤–∞, —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–ø—Ä–∞–≤–∞ */
.modal-buttons-primary {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    flex: 1;
}
.modal-buttons-secondary {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-left: auto;
}
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö */
.modal-button {
    min-width: 100px;
    white-space: nowrap;
}
.modal-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
.modal-button:disabled:hover {
    background: var(--sber-blue);
}
.modal-button, .export-button {
    background: var(--glass-blue);
    color: #ffffff;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    padding: 12px 24px;
    box-shadow: 
        0 2px 8px rgba(0, 122, 255, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    margin-top: 0;
}
.modal-button:hover, .export-button:hover {
    background: #0051D5;
    transform: translateY(-1px);
    box-shadow: 
        0 4px 12px rgba(0, 122, 255, 0.35),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
}
.modal-button:active, .export-button:active {
    transform: translateY(0);
}
#default-btn {
    background: rgba(0, 0, 0, 0.05);
    color: var(--glass-text);
    border: 1px solid rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}
#default-btn:hover {
    background: rgba(0, 0, 0, 0.08);
    border-color: rgba(0, 0, 0, 0.15);
}
.modal-clear-btn {
    background: var(--glass-red);
    color: #ffffff;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    margin-left: 8px;
    padding: 12px 20px;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 
        0 2px 8px rgba(255, 59, 48, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
}
.modal-clear-btn:hover {
    background: var(--glass-red-hover);
    transform: translateY(-1px);
    box-shadow: 
        0 4px 12px rgba(255, 59, 48, 0.35),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
}
.modal-clear-btn:active {
    transform: translateY(0);
}
input, textarea {
    border-radius: 12px;
    border: 1px solid rgba(0, 0, 0, 0.1);
    font-size: 16px;
    padding: 12px 16px;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: var(--glass-text);
    margin-bottom: 0;
    width: 100%;
    box-sizing: border-box;
    transition: all 0.2s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}
input:focus, textarea:focus {
    border-color: var(--glass-blue);
    outline: none;
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 
        0 0 0 3px rgba(0, 122, 255, 0.1),
        0 2px 8px rgba(0, 122, 255, 0.15);
    color: var(--glass-text);
}
.result-box {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 12px;
    padding: 16px;
    font-family: 'SF Mono', 'Monaco', 'Menlo', monospace;
    font-size: 13px;
    margin-top: 18px;
    min-height: 68px;
    color: var(--glass-text);
    white-space: pre-wrap;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
.result, .result-box {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 12px;
    padding: 16px;
    font-family: 'SF Mono', 'Monaco', 'Menlo', monospace;
    font-size: 13px;
    margin-top: 18px;
    min-height: 160px;
    color: var(--glass-text);
    white-space: pre-wrap;
    width: 100%;
    box-sizing: border-box;
    resize: vertical;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}
.result {
    font-size: 13px;
    min-height: 160px;
}
.result-box {
    font-size: 13px;
    min-height: 68px;
}
/* –î–ª—è –±–æ–ª—å—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö */
.modal-large .result {
    min-height: 200px;
}
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫ */
.modal-hint {
    color: var(--glass-text-secondary);
    font-size: 0.95em;
    margin-top: 12px;
    line-height: 1.6;
}
.modal-hint b {
    color: var(--glass-blue);
    font-weight: 600;
}

/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω —Å —Ñ–æ—Ä–º–∞–º–∏ */
.modal-form-group {
    margin-bottom: 18px;
}
.modal-label {
    display: block;
    margin-bottom: 8px;
    color: var(--glass-text);
    font-size: 15px;
    font-weight: 600;
    letter-spacing: -0.2px;
}
.modal-input-row {
    display: flex;
    gap: 8px;
    align-items: center;
}
.modal-input-row .modal-input {
    flex: 1;
}
.modal-input-row .modal-clear-btn {
    flex-shrink: 0;
}
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ–±—â–∏–µ –∫–ª–∞—Å—Å—ã */
#sg-copy-btn {
    margin-top: 10px;
}
/* –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
@media (max-width: 1200px) {
    .modal-content {
        max-width: 96vw;
        min-width: 400px;
        width: 96vw;
        padding: 32px 24px 24px 24px;
    }
    .modal-content.modal-large {
        max-width: 98vw;
        min-width: 500px;
        width: 98vw;
        padding: 36px 20px 28px 20px;
    }
    .modal-content.modal-small {
        max-width: 94vw;
        min-width: 350px;
        width: 94vw;
        padding: 28px 20px 20px 20px;
    }
}
@media (max-width: 600px) {
    .modal-content {
        min-width: 90vw;
        width: 90vw;
        padding: 24px 16px 20px 16px;
    }
    .modal-content.modal-large,
    .modal-content.modal-small {
        min-width: 90vw;
        width: 90vw;
        padding: 24px 16px 20px 16px;
    }
    .modal-title {
        font-size: 20px;
        margin-bottom: 16px;
    }
    .modal-button {
        font-size: 15px;
        padding: 10px 18px;
        min-width: 80px;
    }
}

/* ==== –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä ==== */
.progress-bar {
    background: linear-gradient(90deg, var(--glass-blue) 0%, var(--glass-purple) 100%);
    height: 4px;
    border-radius: 2px;
    box-shadow: 0 1px 3px rgba(0, 122, 255, 0.3);
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ –∫–æ–¥–∞ */
.group-psi-footnote {
  font-size: 12px;
  color: var(--glass-text-secondary);
  user-select: text;
  background: none;
  margin-top: 0;
  text-align: right;
  padding: 0 20px 16px 20px;
}
.group-psi-footnote-code {
  font-family: 'SF Mono', 'Monaco', 'Menlo', monospace;
  opacity: 0.8;
}


/* ==== –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ ==== */
@media (max-width: 1600px) {
    .groups-container { 
        grid-template-columns: repeat(4, 1fr);
        gap: 16px;
    }
}

@media (max-width: 1200px) {
    .groups-container { 
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
    }
    .ios-group-header { font-size: 16px; padding: 14px 18px; }
    .ios-card { font-size: 13px; padding: 10px 14px; }
}

@media (max-width: 900px) {
    .groups-container { 
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }
    .ios-group-header { font-size: 15px; padding: 12px 16px; }
    .ios-card { 
        font-size: 12px; 
        padding: 10px 12px; 
        min-height: 44px;
    }
}

@media (max-width: 600px) {
    .groups-container { 
        grid-template-columns: repeat(1, 1fr);
        gap: 12px;
    }
    .ios-group-header { font-size: 14px; padding: 12px 16px; }
    .ios-card { 
        font-size: 12px; 
        padding: 10px 12px; 
        min-height: 44px;
    }
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ –≤—ã—Å–æ—Ç–µ —ç–∫—Ä–∞–Ω–∞ */
@media (max-height: 900px) {
    .ios-title { font-size: 28px; margin-bottom: 16px; }
    .top-actions { margin-bottom: 12px; gap: 10px; }
    .ios-group-header { font-size: 16px; padding: 12px 16px; }
    .ios-card { 
        font-size: 12px; 
        padding: 8px 12px; 
        min-height: 40px;
    }
    .ios-group-cards { gap: 6px; padding: 10px; }
}

@media (max-height: 700px) {
    .ios-title { font-size: 24px; margin-bottom: 12px; }
    .top-actions { margin-bottom: 10px; gap: 8px; }
    .container { padding: 16px; }
    .ios-group-header { font-size: 14px; padding: 10px 14px; }
    .ios-card { 
        font-size: 11px; 
        padding: 8px 10px; 
        min-height: 36px;
    }
    .ios-group-cards { gap: 6px; padding: 8px; }
    .groups-container { gap: 12px; }
}


</style>

</head>
<body>
<main class="container">
    
    <!-- ===== –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º–∞—è —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å ===== -->
    <section class="groups-viewport" aria-label="–ì—Ä—É–ø–ø—ã —Ä–µ—Å—É—Ä—Å–æ–≤">
        <div class="groups-container" id="groups-container">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑ config.json -->
                </div>
    </section>
</main>


<!-- ===== –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ ===== -->
<div id="progress-bar" class="progress-bar"></div>

<!-- ======= –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ Permission ======= -->
<div id="permission-modal" class="modal" role="dialog" aria-labelledby="permission-modal-title" aria-modal="true">
    <div class="modal-content modal-small">
        <h2 class="modal-title" id="permission-modal-title">–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ Permission</h2>
        <div class="modal-form-group">
            <label for="permission-input" class="modal-label">–í–≤–µ–¥–∏—Ç–µ HEX, –Ω–∞–ø—Ä–∏–º–µ—Ä: 43720e3f, 5228</label>
            <textarea id="permission-input" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ HEX, –Ω–∞–ø—Ä–∏–º–µ—Ä: 43720e3f, 5228"></textarea>
        </div>
        <div class="modal-buttons">
            <div class="modal-buttons-primary">
                <button class="modal-button" id="decode-btn" aria-label="–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å permission">–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="modal-buttons-secondary">
                <button class="modal-button" id="clear-btn" aria-label="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞">–û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="modal-button" id="close-btn" aria-label="–ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
        <pre id="permission-result" class="result-box"></pre>
    </div>
</div>

<!-- ======= –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ ======= -->
<div id="role-modal" class="modal" role="dialog" aria-labelledby="role-modal-title" aria-modal="true">
    <div class="modal-content modal-small">
        <h2 class="modal-title" id="role-modal-title">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h2>
        <div class="modal-form-group">
            <label for="employee-number" class="modal-label">–¢–∞–±–µ–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä</label>
            <div class="modal-input-row">
                <input type="text" id="employee-number" class="modal-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–∞–±–µ–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä" value="673892">
                <button class="modal-button modal-clear-btn" id="clear-emp-btn" title="–û—á–∏—Å—Ç–∏—Ç—å">&#10006;</button>
            </div>
        </div>
        <div class="modal-form-group">
            <label for="role-name" class="modal-label">–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è —Ä–æ–ª—å</label>
            <div class="modal-input-row">
                <input type="text" id="role-name" class="modal-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–æ–ª—å" value="EFS_NB_SUP_BUSINESS_ADMIN_GAMIFICATION">
                <button class="modal-button modal-clear-btn" id="clear-role-btn" title="–û—á–∏—Å—Ç–∏—Ç—å">&#10006;</button>
            </div>
        </div>
        <div class="modal-buttons">
            <div class="modal-buttons-primary">
            <button class="modal-button" id="open-role-link" disabled>–û—Ç–∫—Ä—ã—Ç—å</button>
            </div>
            <div class="modal-buttons-secondary">
                <button class="modal-button" id="default-btn">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
            <button class="modal-button" id="close-role-modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ -->
<div id="scriptgen-modal" class="modal" role="dialog" aria-labelledby="scriptgen-modal-title" aria-modal="true">
  <div class="modal-content modal-large">
    <h2 class="modal-title" id="scriptgen-modal-title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–∞ SalesHeroes</h2>

    <div class="modal-form-group">
      <label for="sg-tournamentIds" class="modal-label">Tournament IDs (—á–µ—Ä–µ–∑ ;):</label>
    <textarea id="sg-tournamentIds" rows="2">t_01_2025-1_05-1_1_3051; t_01_2025-1_05-1_1_3041</textarea>
    </div>

    <div class="modal-form-group">
      <label for="sg-serviceName" class="modal-label">Service Name:</label>
    <input type="text" id="sg-serviceName" value="leadersForAdmin" />
    </div>

    <div class="modal-form-group">
      <label for="sg-apiPath" class="modal-label">Request API Path:</label>
    <input type="text" id="sg-apiPath" value="/bo/rmkib.gamification/api/v1/tournaments/" />
    </div>

    <div class="modal-form-group">
      <label for="sg-urlAlpha" class="modal-label">Request Base URL (ALPHA):</label>
    <input type="text" id="sg-urlAlpha" value="https://efs-our-business-prom.omega.sbrf.ru" />
    </div>

    <div class="modal-form-group">
      <label for="sg-urlSigma" class="modal-label">Request Base URL (SIGMA):</label>
    <input type="text" id="sg-urlSigma" value="https://salesheroes.sberbank.ru" />
    </div>

    <div class="modal-buttons">
      <div class="modal-buttons-primary">
      <button class="modal-button" onclick="generateScriptSber('alpha')">–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ALPHA</button>
      <button class="modal-button" onclick="generateScriptSber('sigma')">–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å SIGMA</button>
      </div>
      <div class="modal-buttons-secondary">
      <button class="modal-button" id="sg-default-btn" type="button">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
      <button class="modal-button" id="sg-clear-btn" type="button">–û—á–∏—Å—Ç–∏—Ç—å</button>
        <button class="modal-button" id="sg-copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="modal-button" id="close-scriptgen-modal">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>

    <div class="modal-form-group">
      <label for="sg-result" class="modal-label">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:</label>
      <textarea id="sg-result" class="result" rows="15" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç"></textarea>
    </div>
  </div>
</div>

<div id="tn-modal" class="modal" role="dialog" aria-labelledby="tn-modal-title" aria-modal="true">
  <div class="modal-content modal-large">
    <h2 class="modal-title" id="tn-modal-title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è addressBook –ø–æ –¢–ù</h2>
    <div class="modal-form-group">
      <label for="tn_input" class="modal-label">–í–≤–µ–¥–∏—Ç–µ –¢–ù —á–µ—Ä–µ–∑ –ª—é–±—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ (–ø—Ä–æ–±–µ–ª—ã, ; , : . –∏ —Ç.–¥.):</label>
    <textarea id="tn_input" rows="3" placeholder="12345, 54321; 13579 24680"></textarea>
    </div>
    <div class="modal-buttons">
      <div class="modal-buttons-primary">
      <button class="modal-button" id="tn-gen-btn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç</button>
      </div>
      <div class="modal-buttons-secondary">
      <button class="modal-button" id="tn-copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="modal-button" id="tn-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    </div>
    <textarea class="result" id="out_tn" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç"></textarea>
    <div class="modal-hint">
      –í—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ DevTools –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ addressBook.<br>–í—ã–≥—Ä—É–∑–∫–∞ –ø–æ <b>/api/home/empInfoFull?empId=...</b>
    </div>
  </div>
</div>

<div id="dep-modal" class="modal" role="dialog" aria-labelledby="dep-modal-title" aria-modal="true">
  <div class="modal-content modal-large">
    <h2 class="modal-title" id="dep-modal-title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è addressBook –ø–æ –∫–æ–¥—É –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</h2>
    <div class="modal-form-group">
      <label for="dep_input" class="modal-label">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥—ã –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ª—é–±—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ (–ø—Ä–æ–±–µ–ª—ã, ; , : . –∏ —Ç.–¥.):</label>
    <textarea id="dep_input" rows="3" placeholder="10294215, 10294220; 10294444"></textarea>
    </div>
    <div class="modal-buttons">
      <div class="modal-buttons-primary">
      <button class="modal-button" id="dep-gen-btn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç</button>
      </div>
      <div class="modal-buttons-secondary">
      <button class="modal-button" id="dep-copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="modal-button" id="dep-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    </div>
    <textarea class="result" id="out_dep" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç"></textarea>
    <div class="modal-hint">
      –í—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ DevTools –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ addressBook.<br>–í—ã–≥—Ä—É–∑–∫–∞ –ø–æ <b>/api/home/departments/&lt;–∫–æ–¥&gt;/employees:search</b>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–∫–∏ –Ω–æ–≤–æ—Å—Ç–∏ -->
<div id="news-modal" class="modal" role="dialog" aria-labelledby="news-modal-title" aria-modal="true">
  <div class="modal-content modal-large">
    <h2 class="modal-title" id="news-modal-title">–í—ã–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–∫–∏ –ø–æ –Ω–æ–≤–æ—Å—Ç—è–º</h2>
    <div class="modal-form-group">
      <label for="news_input" class="modal-label">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥—ã –Ω–æ–≤–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª, –∑–∞–ø—è—Ç—É—é –∏–ª–∏ ;</label>
    <textarea id="news_input" rows="3" placeholder="715429170081770418; 715429169708477428"></textarea>
    </div>
    <div class="modal-buttons">
      <div class="modal-buttons-primary">
      <button class="modal-button" id="news-alpha-btn">Alpha</button>
      <button class="modal-button" id="news-sigma-btn">Sigma</button>
      </div>
      <div class="modal-buttons-secondary">
      <button class="modal-button" id="news-default-btn">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
      <button class="modal-button" id="news-copy-btn" disabled>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="modal-button" id="news-clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
      <button class="modal-button" id="news-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    </div>
    <textarea class="result" id="news-output" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç"></textarea>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ REWARD -->
<div id="reward-modal" class="modal" role="dialog" aria-labelledby="reward-modal-title" aria-modal="true">
  <div class="modal-content modal-large">
    <h2 class="modal-title" id="reward-modal-title">–í—ã–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–∞–≥—Ä–∞–¥–∞–º</h2>
    <div class="modal-form-group">
      <label for="reward-input" class="modal-label">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥—ã –Ω–∞–≥—Ä–∞–¥ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª, –∑–∞–ø—è—Ç—É—é –∏–ª–∏ ;</label>
    <textarea id="reward-input" rows="3" placeholder="r_01_2025-0_10-1_2; r_01_2025-0_10-1_1"></textarea>
    </div>
    <div class="modal-buttons">
      <div class="modal-buttons-primary">
      <button class="modal-button" id="reward-alpha-btn">Alpha</button>
      <button class="modal-button" id="reward-sigma-btn">Sigma</button>
      </div>
      <div class="modal-buttons-secondary">
      <button class="modal-button" id="reward-default-btn">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
      <button class="modal-button" id="reward-copy-btn" disabled>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="modal-button" id="reward-clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
      <button class="modal-button" id="reward-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    </div>
    <textarea id="reward-result" class="result" rows="10" readonly placeholder="–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å"></textarea>
    <div class="modal-hint">
      –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å DevTools.<br>
      –°–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, —Å–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∞–π–ª JSON.<br>
      –õ–æ–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞.
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è -->
<div id="profile-modal" class="modal" role="dialog" aria-labelledby="profile-modal-title" aria-modal="true">
  <div class="modal-content modal-large">
    <h2 class="modal-title" id="profile-modal-title">–í—ã–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ —Ç–∞–±–µ–ª—å–Ω—ã–º</h2>
    <div class="modal-form-group">
      <label for="profile-input" class="modal-label">–í–≤–µ–¥–∏—Ç–µ —Ç–∞–±–µ–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ (—á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª, —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π, –∑–∞–ø—è—Ç—É—é, –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ –∏ —Ç.–¥.):</label>
    <textarea id="profile-input" rows="3" placeholder="01234567; 78965432&#10;11223344"></textarea>
    </div>
    <div class="modal-buttons">
      <div class="modal-buttons-primary">
      <button class="modal-button" id="profile-alpha-btn">ALPHA</button>
      <button class="modal-button" id="profile-sigma-btn">SIGMA</button>
      </div>
      <div class="modal-buttons-secondary">
      <button class="modal-button" id="profile-copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="modal-button" id="profile-default-btn">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
      <button class="modal-button" id="profile-clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
      <button class="modal-button" id="profile-close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    </div>
    <textarea class="result" id="profile-output" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç –¥–ª—è DevTools"></textarea>
    <div class="modal-hint">
      –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ DevTools (F12) –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ—Ñ–∏–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç cookie –≤–∞—à–µ–π —Å–µ—Å—Å–∏–∏, –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 100–º—Å, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON-—Ñ–∞–π–ª.
    </div>
  </div>
</div>


</div>






<!-- ======= –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (fallback –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞) ======= -->
<script>
// –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ config.json)
// –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ config.json
let embeddedConfig = null;
// === –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ===
const CONFIG = {
    LINK_CHECK_INTERVAL: 120000, // 2 –º–∏–Ω—É—Ç—ã –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
    REQUEST_DELAY: 1000, // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
    PROFILE_REQUEST_DELAY: 10, // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ—Ñ–∏–ª–µ–π
    FETCH_TIMEOUT: 5000, // –¢–∞–π–º–∞—É—Ç –¥–ª—è fetch-–∑–∞–ø—Ä–æ—Å–æ–≤
    MAX_PARALLEL_REQUESTS: 5, // –ú–∞–∫—Å–∏–º—É–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    PROGRESS_BAR_ANIMATION_STEP: 24, // –®–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
    PROGRESS_BAR_ANIMATION_INTERVAL: 100, // –ò–Ω—Ç–µ—Ä–≤–∞–ª –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
    LOGGING_ENABLED: false // –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
};

// === –£—Ç–∏–ª–∏—Ç—ã ===
// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ —Å fallback –¥–ª—è SberBrowser
function copyToClipboard(text, buttonElement) {
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => {
            if (buttonElement) {
                const originalText = buttonElement.textContent;
                buttonElement.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                setTimeout(() => {
                    buttonElement.textContent = originalText;
                }, 1200);
            }
        }).catch(err => {
            console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Clipboard API:', err);
            fallbackCopyToClipboard(text, buttonElement);
        });
    } else {
        fallbackCopyToClipboard(text, buttonElement);
    }
}

// Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ –∏ SberBrowser
function fallbackCopyToClipboard(text, buttonElement) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    textArea.style.top = '-999999px';
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful && buttonElement) {
            const originalText = buttonElement.textContent;
            buttonElement.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
            setTimeout(() => {
                buttonElement.textContent = originalText;
            }, 1200);
        }
    } catch (err) {
        console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ execCommand:', err);
    } finally {
        document.body.removeChild(textArea);
    }
}

// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞
function safeQuerySelector(selector, context = document) {
    const element = context.querySelector(selector);
    if (!element && CONFIG.LOGGING_ENABLED) {
        console.warn(`–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω: ${selector}`);
    }
    return element;
}

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—Ç–∫–ª—é—á–∞–µ–º–æ–µ)
const Logger = {
    log(level, message, data = null) {
        if (!CONFIG.LOGGING_ENABLED) return;
        const timestamp = new Date().toISOString();
        const logMessage = `[${timestamp}] [${level}] ${message}`;
        if (data) {
            console[level.toLowerCase()](logMessage, data);
        } else {
            console[level.toLowerCase()](logMessage);
        }
    },
    debug(message, data) { this.log('DEBUG', message, data); },
    info(message, data) { this.log('INFO', message, data); },
    warn(message, data) { this.log('WARN', message, data); },
    error(message, data) { this.log('ERROR', message, data); }
};

// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
const ModalManager = {
    modals: new Map(),
    
    register(id, options = {}) {
        const modal = safeQuerySelector(`#${id}`);
        if (!modal) return;
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        const config = {
            closeOnBackdrop: options.closeOnBackdrop !== false,
            closeOnEscape: options.closeOnEscape !== false,
            trapFocus: options.trapFocus !== false
        };
        
        this.modals.set(id, { modal, config });
        this.setupEventListeners(id);
    },
    
    setupEventListeners(id) {
        const { modal, config } = this.modals.get(id);
        if (!modal) return;
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
        if (config.closeOnBackdrop) {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    this.close(id);
                }
            });
        }
    },
    
    open(id) {
        const { modal, config } = this.modals.get(id);
        if (!modal) return;
        modal.classList.add('show');
        if (config.trapFocus) {
            this.trapFocus(modal);
        }
        Logger.debug(`–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ: ${id}`);
    },
    
    close(id) {
        const { modal } = this.modals.get(id);
        if (!modal) return;
        modal.classList.remove('show');
        Logger.debug(`–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫—Ä—ã—Ç–æ: ${id}`);
    },
    
    trapFocus(modal) {
        const focusableElements = modal.querySelectorAll(
            'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );
        if (focusableElements.length === 0) return;
        
        const firstElement = focusableElements[0];
        const lastElement = focusableElements[focusableElements.length - 1];
        
        const handleTab = (e) => {
            if (e.key !== 'Tab') return;
            
            if (e.shiftKey) {
                if (document.activeElement === firstElement) {
                    lastElement.focus();
                    e.preventDefault();
                }
            } else {
                if (document.activeElement === lastElement) {
                    firstElement.focus();
                    e.preventDefault();
                }
            }
        };
        
        modal.addEventListener('keydown', handleTab);
        firstElement.focus();
    }
};

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const openModal = document.querySelector('.modal.show');
        if (openModal) {
            const modalId = openModal.id;
            if (modalId) {
                ModalManager.close(modalId);
            } else {
                openModal.classList.remove('show');
            }
        }
    }
});

// === –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ===
let cardDataMap = new Map(); // –ú–∞–ø–ø–∏–Ω–≥ ID –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ –∏—Ö –¥–∞–Ω–Ω—ã–µ

// –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ JSON (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)


// –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞ ID –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ –∏—Ö –¥–∞–Ω–Ω—ã–µ
function buildCardDataMap(groups) {
    cardDataMap.clear();
    groups.forEach(group => {
        group.cards.forEach(card => {
            if (card.id) {
                cardDataMap.set(card.id, card);
            }
        });
    });
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ ID
function getCardDataById(id) {
    return cardDataMap.get(id);
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≥—Ä—É–ø–ø
function renderGroups(groups) {
    const container = safeQuerySelector('#groups-container');
    if (!container) {
        Logger.error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä—É–ø–ø –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }
    
    // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    container.innerHTML = '';
    
    groups.forEach(group => {
        const groupElement = createGroupElement(group);
        container.appendChild(groupElement);
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    initDynamicEventHandlers();
    
    // –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    adjustTopActions();
}

// –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≥—Ä—É–ø–ø—ã
function createGroupElement(group) {
    const article = document.createElement('article');
    article.className = 'ios-group';
    const headerId = group.isAdmin ? 'group-admin-header' : `group-${group.id}-header`;
    article.setAttribute('aria-labelledby', headerId);
    
    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≥—Ä—É–ø–ø—ã
    const header = document.createElement('div');
    header.className = group.isAdmin ? `ios-group-header group-admin` : `ios-group-header group-${group.id}`;
    header.id = headerId;
    header.textContent = group.name;
    article.appendChild(header);
    
    // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
    const cardsContainer = document.createElement('div');
    cardsContainer.className = 'ios-group-cards';
    
    // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
    group.cards.forEach(card => {
        const cardElement = createCardElement(card);
        cardsContainer.appendChild(cardElement);
    });
    
    article.appendChild(cardsContainer);
    
    // –ö–æ–¥ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–¥ –≥—Ä—É–ø–ø–∞–º–∏ (—Å–∫—Ä—ã—Ç)
    // if (group.code) {
    //     const footnote = document.createElement('div');
    //     footnote.className = 'group-psi-footnote';
    //     const codeSpan = document.createElement('span');
    //     codeSpan.className = 'group-psi-footnote-code';
    //     codeSpan.textContent = group.code;
    //     footnote.appendChild(codeSpan);
    //     article.appendChild(footnote);
    // }
    
    return article;
}

// –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
function createCardElement(card) {
    const link = document.createElement('a');
    link.href = card.url || '#';
    link.className = 'ios-card';
    
    // –ï—Å–ª–∏ —ç—Ç–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞, –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
    if (!card.isModal && card.url && card.url !== '#' && !card.url.startsWith('#')) {
        link.target = '_blank';
        // –£–±–∏—Ä–∞–µ–º focus state –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ –Ω–∞ —Å—Å—ã–ª–∫—É
        link.addEventListener('click', function(e) {
            // –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å—Å—ã–ª–∫–∏, –∑–∞—Ç–µ–º —É–±–∏—Ä–∞–µ–º focus
            setTimeout(() => {
                this.blur();
            }, 100);
        });
    }
    
    if (card.id) {
        link.id = card.id;
    }
    
    const title = document.createElement('span');
    title.className = 'ios-card-title';
    title.textContent = card.title;
    link.appendChild(title);
    
    return link;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
function initDynamicEventHandlers() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–æ–¥–∞
    cardDataMap.forEach((cardData, cardId) => {
        const cardElement = safeQuerySelector(`#${cardId}`);
        if (cardElement && cardData.copyCode) {
            cardElement.addEventListener('click', function(e) {
                // –ï—Å–ª–∏ —ç—Ç–æ —Å—Å—ã–ª–∫–∞ —Å href="#", –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥
                if (cardElement.href === '#' || cardElement.href.endsWith('#')) {
                    e.preventDefault();
                }
                copyToClipboard(cardData.copyCode, null);
                cardElement.classList.add('copied-blink');
                setTimeout(() => cardElement.classList.remove('copied-blink'), 600);
            });
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω (–≥—Ä—É–ø–ø–∞ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ)
    const modalLinks = {
        'open-permission-modal-link': () => {
            const modal = safeQuerySelector('#permission-modal');
            if (modal) {
                modal.classList.add('show');
                const input = safeQuerySelector('#permission-input');
                if (input) input.focus();
            }
        },
        'open-role-modal-link': () => {
            const modal = safeQuerySelector('#role-modal');
            if (modal) {
                modal.classList.add('show');
                const input = safeQuerySelector('#employee-number');
                if (input) input.focus();
            }
        },
        'open-scriptgen-modal-link': () => {
            const modal = safeQuerySelector('#scriptgen-modal');
            if (modal) {
                modal.classList.add('show');
                const result = safeQuerySelector('#sg-result');
                if (result) result.value = '';
                const input = safeQuerySelector('#sg-tournamentIds');
                if (input) input.focus();
            }
        },
        'open-reward-modal-link': () => {
            const modal = safeQuerySelector('#reward-modal');
            if (modal) {
                modal.classList.add('show');
                const input = safeQuerySelector('#reward-input');
                if (input) input.focus();
            }
        },
        'open-news-modal-link': () => {
            const modal = safeQuerySelector('#news-modal');
            if (modal) modal.classList.add('show');
        },
        'open-profile-modal-link': () => {
            const modal = safeQuerySelector('#profile-modal');
            if (modal) {
                modal.classList.add('show');
                const input = safeQuerySelector('#profile-input');
                if (input) input.focus();
            }
        },
        'open-tn-modal-link': () => {
            const modal = safeQuerySelector('#tn-modal');
            if (modal) {
                modal.classList.add('show');
                const input = safeQuerySelector('#tn_input');
                if (input) {
                    input.value = '';
                    input.focus();
                }
            }
        },
        'open-dep-modal-link': () => {
            const modal = safeQuerySelector('#dep-modal');
            if (modal) {
                modal.classList.add('show');
                const input = safeQuerySelector('#dep_input');
                if (input) {
                    input.value = '';
                    input.focus();
                }
            }
        }
    };
    
    Object.keys(modalLinks).forEach(id => {
        const element = safeQuerySelector(`#${id}`);
        if (element) {
            element.addEventListener('click', function(e) {
                e.preventDefault();
                modalLinks[id]();
            });
        }
    });
}

function loadAndRenderConfig() {
    const container = safeQuerySelector('#groups-container');
    if (!container) {
        console.error('‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä #groups-container –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ DOM!');
        console.error('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç —Å id="groups-container" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ HTML');
        document.body.innerHTML = '<div style="padding: 40px; text-align: center; color: red;"><h2>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞</h2><p>–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä #groups-container –Ω–µ –Ω–∞–π–¥–µ–Ω</p></div>';
        return;
    }
    
    console.log('‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–π–¥–µ–Ω, –Ω–∞—á–∏–Ω–∞—é –∑–∞–≥—Ä—É–∑–∫—É...');
    
    try {
        console.log('üîÑ –ò—Å–ø–æ–ª—å–∑—É—é –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é...');
        
        // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        const config = JSON.parse(`{
  "groups": [
    {
      "id": 1,
      "name": "–í—Å—Ç—Ä–µ—á–∏ (Jazz)",
      "code": null,
      "cards": [
        {
          "title": "SberJazz",
          "url": "https://jazz.sberbank.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–î–µ–π–ª–∏ (–ì–µ—Ä–æ–∏ –ø—Ä–æ–¥–∞–∂)",
          "url": "https://jazz.sberbank.ru/sber-7g5cqu?psw=OBUVBwADHB0IBRIRXxcLDgcPDw",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ü–ö–ê–ü –í—Å—Ç—Ä–µ—á–∞",
          "url": "https://jazz.sberbank.ru/sber-gzdl5c?psw=OEcNEgsBXAZeVwoEVBVLFVFdFw",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ü–ö–ê–ü –°–µ—Ä–≥–µ–π",
          "url": "https://jazz.sberbank.ru/sber-jd9r1x?psw=OBoIEQsCHAVcCg8HVBYLFlMAEg",
          "id": null,
          "copyCode": null
        },
        {
          "title": "iMAC",
          "url": "https://jazz.sberbank.ru/sber-mnv6vl?psw=OEEKAUUdDBVeUQ0XGgkbBlFbEA",
          "id": null,
          "copyCode": null
        }
      ]
    },
    {
      "id": 2,
      "name": "–ì–µ—Ä–æ–∏ –ø—Ä–æ–¥–∞–∂ (PROM / PSI / IFT)",
      "code": "92863949",
      "cards": [
        {
          "title": "(PROM) –ì–ü - Alpha",
          "url": "https://efs-our-business-prom.omega.sbrf.ru/salesheroes/community",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PROM) –ì–ü - Sigma",
          "url": "https://salesheroes.sberbank.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PSI) –ì–ü - Alpha",
          "url": "https://iam-enigma-psi.omega.sbrf.ru/",
          "id": "psi-alpha-btn",
          "copyCode": "92863949"
        },
        {
          "title": "(PSI) –ì–ü - Sigma",
          "url": "https://salesheroes-psi.sigma.sbrf.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ò–§–¢ –°–ë",
          "url": "https://iam-enigma-ift-sb.delta.sbrf.ru/salesheroes/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ò–§–¢ –ì–§",
          "url": "https://iam-enigma-ift.delta.sbrf.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ò–§–¢ –°–ë –°–∏–≥–º–∞",
          "url": "https://salesheroes-sb.sigma.sbrf.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ò–§–¢ –ì–§ (–°–∏–≥–º–∞)",
          "url": "https://salesheroes-gf.sigma.sbrf.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ò–§–¢ –°–ë (–Ω–æ–≤—ã–π)",
          "url": "https://efs-ift-sb.delta.sbrf.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ò–§–¢ –ì–§ (–Ω–æ–≤—ã–π)",
          "url": "https://efs-ift-gf.delta.sbrf.ru/salesheroes",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PROM) –ö–ê–ü",
          "url": "https://pvlos-sys000001.omega.sbrf.ru/SberDataCorr",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PSI) –ö–ê–ü",
          "url": "https://tklos-sys000001.omega.sbrf.ru/SberDataCorr",
          "id": "psi2-alpha-btn",
          "copyCode": "92863949"
        },
        {
          "title": "(PSI) –ö–ê–ü (New)",
          "url": "https://tvlos-sys000001.cloud.omega.sbrf.ru/",
          "id": "psi2-alpha-btn-new",
          "copyCode": "92863949"
        }
      ]
    },
    {
      "id": 3,
      "name": "–†–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã",
      "code": "omega\\\\01803187",
      "cards": [
        {
          "title": "–°–±–µ—Ä–ß–∞—Ç",
          "url": "https://sberchat.sberbank.ru/#/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ê–¥—Ä–µ—Å–Ω–∞—è –∫–Ω–∏–≥–∞",
          "url": "https://addressbook/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "Service Manager (Alpha)",
          "url": "https://servicemanager.omega.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ú–æ–∏ –¥–æ—Å—Ç—É–ø—ã (Alpha)",
          "url": "https://smd.omega.sbrf.ru/SberAccess/#/pa?tab=0",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ü—É–ª—å—Å (Alpha)",
          "url": "https://hr.ca.sbrf.ru/platform/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "Clickstream",
          "url": "https://clickstream-prom.ca.sbrf.ru/frontend/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "Citrix Workspace",
          "url": "https://cab-snp-cx00001.omega.sbrf.ru/",
          "id": "citrix-alpha-btn",
          "copyCode": "omega\\\\01803187"
        },
        {
          "title": "SberESM",
          "url": "https://sberesm.omega.sbrf.ru/efs-ermops-static/app-ops_esm",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(–ò–§–¢) –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö CTL",
          "url": "https://ctl-ift.qa.df.sbrf.ru:9080/#/sign-in",
          "id": "ctl-sigma-btn",
          "copyCode": "lakomkin-oo"
        },
        {
          "title": "(PSI) –¢–µ–Ω–≥—Ä–∏",
          "url": "https://ci02587203-psi-iam-proxy-client-geo.omega.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PROM) –¢–µ–Ω–≥—Ä–∏ (Indicator)",
          "url": "https://ci02587203-iam-proxy-main.prom-29-30-apps.ocp-geo.ocp.ca.sbrf.ru/indicator-efs-empl/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PROM) –¢–µ–Ω–≥—Ä–∏ (Ulogger)",
          "url": "https://ci02587203-iam-proxy-main.prom-29-30-apps.ocp-geo.ocp.ca.sbrf.ru/indicator-efs-empl/a/logger/logs?orgId=1",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PROM) –¢–µ–Ω–≥—Ä–∏ (Base)",
          "url": "https://ci02587203-prom-iam-proxy-main-geo.omega.sbrf.ru/indicator-efs-empl/a/logger/logs?orgId=6&from=now-15m&to=now",
          "id": null,
          "copyCode": null
        }
      ]
    },
    {
      "id": 4,
      "name": "–°–£–ü",
      "code": null,
      "cards": [
        {
          "title": "(PROM GF_SK) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–£–ü",
          "url": "https://iamproxy-prom-gfsk.ingress.apps.arqgec5q.k8s.ca.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PROM GF_MG) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–£–ü",
          "url": "https://iamproxy-prom-gfmg.ingress.apps.arq6r3xx.k8s.ca.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PSI) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–£–ü [EFSEMP-IAM-GF-SK]",
          "url": "https://iamproxy-psi-gfsk.ingress.apps.aq6omvfr.k8s.ca.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PSI) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–£–ü [EFSEMP-IAM-GF-MG]",
          "url": "https://iamproxy-psi-gfmg.ingress.apps.aq664prc.k8s.ca.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PSI) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–£–ü [EFSEMP-IAM-SB-SK]",
          "url": "https://iamproxy-psi-sbsk.ingress.apps.aq6jo46q.k8s.ca.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "(PSI) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–£–ü [EFSEMP-IAM-SB-MG]",
          "url": "https://iamproxy-psi-sbmg.ingress.apps.aq6655vb.k8s.ca.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–û —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –°–£–ü –ø—Ä–æ–º",
          "url": "https://confluence.sberbank.ru/pages/viewpage.action?pageId=12034673436",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–û –¥–æ—Å—Ç—É–ø–µ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –°–£–ü –ø—Ä–æ–º",
          "url": "https://confluence.sberbank.ru/pages/viewpage.action?pageId=11862715264",
          "id": null,
          "copyCode": null
        }
      ]
    },
    {
      "id": 5,
      "name": "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –¥–∞–Ω–Ω—ã—Ö",
      "code": null,
      "cards": [
        {
          "title": "QS",
          "url": "https://vpokib.ca.sbrf.ru/main/hub/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "VARM LabZone Office Alpha i57z",
          "url": "https://a-lz.omega.sbrf.ru",
          "id": "varm-alpha-btn",
          "copyCode": "omega\\\\01803187"
        },
        {
          "title": "HUE",
          "url": "http://pklis-mvp003253.labiac.df.sbrf.ru:8888/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "JupyterHub",
          "url": "https://pklis-mvp003259.labiac.df.sbrf.ru:8000/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "AMBARI",
          "url": "http://pklis-mvp003251.labiac.df.sbrf.ru:8080/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–î–ë GigaChat (Sigma)",
          "url": "https://oko-qs.sigma.sbrf.ru/prom/sense/app/ea9927f5-64f7-473e-8c3d-c46bd4cea768/sheet/062666f6-eafd-4b58-815d-59754ef81c33/state/analysis",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–î–ë QS (Sigma)",
          "url": "https://oko-qs.sigma.sbrf.ru",
          "id": null,
          "copyCode": null
        }
      ]
    },
    {
      "id": 6,
      "name": "–†–µ—Å—É—Ä—Å—ã Confluence",
      "code": null,
      "cards": [
        {
          "title": "–ë–µ–∫–õ–æ–≥ –§–∞–±—Ä–∏–∫–∞",
          "url": "https://confluence.sberbank.ru/pages/viewpage.action?pageId=17521445497",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ê–≤—Ç–æ –¢–£–†–ù–ò–†–´",
          "url": "https://confluence.sberbank.ru/pages/viewpage.action?pageId=11671348420",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–°–ü–†–ò–ù–¢",
          "url": "https://jira.sberbank.ru/secure/RapidBoard.jspa?rapidView=32210&view=planning.nodetail&selectedIssue=HERO-3166&issueLimit=100",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ü–ö–ê–ü",
          "url": "https://jira.delta.sbrf.ru/secure/StructureBoard.jspa?s=19119#",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–°—Ç—Ä—É–∫—Ç—É—Ä–∞",
          "url": "https://confluence.delta.sbrf.ru/pages/viewpage.action?pageId=9073267075",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ë–¢ —Ñ–∞–±—Ä–∏–∫–∞",
          "url": "https://confluence.sberbank.ru/pages/viewpage.action?pageId=9528155757",
          "id": null,
          "copyCode": null
        },
        {
          "title": "DevOps-–ø–æ—Ä—Ç–∞–ª",
          "url": "https://sso.devopsportal.sigma.sbrf.ru/dop/#/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ó–∞–¥–∞—á–∏ 2 –∫–≤",
          "url": "https://jira.sberbank.ru/browse/HERO-4358",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ó–∞–¥–∞—á–∏ 1 –∫–≤",
          "url": "https://jira.sberbank.ru/secure/RapidBoard.jspa?rapidView=32210&view=planning.nodetail&selectedIssue=HERO-3088&issueLimit=100",
          "id": null,
          "copyCode": null
        }
      ]
    },
    {
      "id": 7,
      "name": "–ü—Ä–æ—á–µ–µ —Ä–∞–±–æ—á–µ–µ",
      "code": null,
      "cards": [
        {
          "title": "–î—Ä—É–≥",
          "url": "https://sberfriend.ca.sbrf.ru/sberfriend/#/dashboard",
          "id": null,
          "copyCode": null
        },
        {
          "title": "Service Manager (Sigma)",
          "url": "https://adv-gate.sigma.sbrf.ru/Citrix/ADVWeb/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ï–°–† (Sigma)",
          "url": "https://esr.sigma.sbrf.ru/",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–î–æ—Å–∫–∞ –ö–æ–º–∞–Ω–¥",
          "url": "https://agile.sber.ru/dashboard/#/?0%5BlocationState%5D=true",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ú–æ–∏ –¥–æ—Å—Ç—É–ø—ã (Sigma)",
          "url": "https://sberu.sigma.sbrf.ru/SberWelcome/#/pa",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ü—É–ª—å—Å (Sigma)",
          "url": "https://hr.sberbank.ru/platform/dashboard",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ü–æ—á—Ç–∞ (Sigma)",
          "url": "https://mail.sberbank.ru/owa/#path=/mail",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–ì—Ä–∞—Ñ–∏–∫ –ø–µ—Ä–∏–æ–¥–æ–≤",
          "url": "https://confluence.ca.sbrf.ru/pages/viewpage.action?pageId=8956707657",
          "id": null,
          "copyCode": null
        },
        {
          "title": "–¢–§–°/–ü–∞–∫–µ—Ç–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ (–±—ç–∫–ª–æ–≥)",
          "url": "https://selfportal.dev.df.sbrf.ru/support/templates/supportfd",
          "id": null,
          "copyCode": null
        }
      ]
    },
    {
      "id": 8,
      "name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ",
      "code": null,
      "isAdmin": true,
      "cards": [
        {
          "title": "–î–µ–∫–æ–¥–µ—Ä permission",
          "url": "#",
          "id": "open-permission-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ (–ü–°–ò)",
          "url": "#",
          "id": "open-role-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "LeadersForAdmin",
          "url": "#",
          "id": "open-scriptgen-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "Reward",
          "url": "#",
          "id": "open-reward-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "News Details",
          "url": "#",
          "id": "open-news-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "–ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ —Ç–∞–±–µ–ª—å–Ω—ã–º",
          "url": "#",
          "id": "open-profile-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "AdressBook –¢–ù",
          "url": "#",
          "id": "open-tn-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "AdressBook –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è",
          "url": "#",
          "id": "open-dep-modal-link",
          "copyCode": null,
          "isModal": true
        },
        {
          "title": "–≠–∫—Å–ø–æ—Ä—Ç —Å—Å—ã–ª–æ–∫",
          "url": "#",
          "id": "export-links-btn-link",
          "copyCode": null,
          "isModal": false
        }
      ]
    }
  ]
}`);
        
        console.log('‚úÖ JSON –∑–∞–≥—Ä—É–∂–µ–Ω, –≥—Ä—É–ø–ø:', config.groups.length);
        console.log('üîÑ –ù–∞—á–∏–Ω–∞—é –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞ –∫–∞—Ä—Ç–æ—á–µ–∫...');
        buildCardDataMap(config.groups);
        console.log('üîÑ –ù–∞—á–∏–Ω–∞—é —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≥—Ä—É–ø–ø...');
        renderGroups(config.groups);
        Logger.info('–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–∞', { groupsCount: config.groups.length });
        console.log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–∞');
        
        // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        setTimeout(() => {
            adaptGroupsToFit();
        }, 100);
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:', error);
        Logger.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏', { error: error.message });
    }
}

// –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞ ID –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ –∏—Ö –¥–∞–Ω–Ω—ã–µ













// === –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä—É–ø–ø –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ ===
function adaptGroupsToFit() {
    const groups = document.querySelectorAll('.ios-group');
    // –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –≤ 3 —Å—Ç—Ä–æ–∫–∏ –º–∞–∫—Å–∏–º—É–º
    const BASE_FONT_SIZE = 15; // –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (—É–≤–µ–ª–∏—á–µ–Ω)
    const MIN_FONT_SIZE = 12; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (—É–≤–µ–ª–∏—á–µ–Ω –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏)
    const MIN_PADDING = 6; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π padding (–≤–µ—Ä—Ö/–Ω–∏–∑) - —É–º–µ–Ω—å—à–µ–Ω –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –º–µ—Å—Ç–∞ –ø–æ–¥ —Ç–µ–∫—Å—Ç
    const MIN_HEIGHT = 52; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ (—É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è)
    const MAX_HEIGHT = 78; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ (—É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–ª—è 3 —Å—Ç—Ä–æ–∫ —Ç–µ–∫—Å—Ç–∞)
    const MIN_GAP = 6; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π gap –º–µ–∂–¥—É –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≥—Ä—É–ø–ø—ã –Ω–µ —É–º–µ–Ω—å—à–∞–µ–º - –æ–Ω –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–∞ –≤—Å–µ—Ö –≥—Ä—É–ø–ø–∞—Ö
    
    groups.forEach(group => {
        const cardsContainer = group.querySelector('.ios-group-cards');
        if (!cardsContainer) return;
        
        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ computed styles
        const firstCard = cardsContainer.querySelector('.ios-card');
        if (!firstCard) return;
        
        const computedStyle = window.getComputedStyle(firstCard);
        const originalFontSize = parseFloat(computedStyle.fontSize);
        const originalPaddingTop = parseFloat(computedStyle.paddingTop);
        const originalPaddingBottom = parseFloat(computedStyle.paddingBottom);
        const originalMinHeight = parseFloat(computedStyle.minHeight);
        const originalGap = parseFloat(window.getComputedStyle(cardsContainer).gap) || 8;
        
        let currentFontSize = originalFontSize;
        let currentPaddingTop = originalPaddingTop;
        let currentPaddingBottom = originalPaddingBottom;
        let currentMinHeight = originalMinHeight;
        let currentGap = originalGap;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π layout (column)
        const originalDisplay = window.getComputedStyle(cardsContainer).display;
        const originalFlexDirection = window.getComputedStyle(cardsContainer).flexDirection;
        let isTwoColumns = false;
        
        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        function needsScroll() {
            return cardsContainer.scrollHeight > cardsContainer.clientHeight + 1; // +1 –¥–ª—è —É—á–µ—Ç–∞ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω–æ–≥–æ layout
        function applyTwoColumns() {
            if (isTwoColumns) return; // –£–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π gap
            const currentGapValue = window.getComputedStyle(cardsContainer).gap;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º grid —Å 2 –∫–æ–ª–æ–Ω–∫–∞–º–∏
            cardsContainer.style.display = 'grid';
            cardsContainer.style.gridTemplateColumns = '1fr 1fr';
            cardsContainer.style.flexDirection = 'unset';
            cardsContainer.style.gap = currentGapValue;
            
            isTwoColumns = true;
            // –£–±—Ä–∞–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
            // console.debug(`–ì—Ä—É–ø–ø–∞ "${group.querySelector('.ios-group-header')?.textContent}" –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞ –Ω–∞ –¥–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π layout`);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –æ–¥–Ω–æ–∫–æ–ª–æ–Ω–æ—á–Ω–æ–º—É layout
        function revertToSingleColumn() {
            if (!isTwoColumns) return; // –£–∂–µ –æ–¥–Ω–æ–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π
            
            cardsContainer.style.display = originalDisplay;
            cardsContainer.style.flexDirection = originalFlexDirection;
            cardsContainer.style.gridTemplateColumns = 'unset';
            
            isTwoColumns = false;
            // –£–±—Ä–∞–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
            // console.debug(`–ì—Ä—É–ø–ø–∞ "${group.querySelector('.ios-group-header')?.textContent}" –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –∫ –æ–¥–Ω–æ–∫–æ–ª–æ–Ω–æ—á–Ω–æ–º—É layout`);
        }
        
        // –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤
        // –¢–µ–ø–µ—Ä—å —É–º–µ–Ω—å—à–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ 3 —Å—Ç—Ä–æ–∫–∏
        function reduceSizes(iteration = 0) {
            if (iteration > 20) {
                // –î–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π - –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
                cardsContainer.style.overflowY = 'auto';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–∞ –ª–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
            if (!needsScroll()) {
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞ - —Å–∫—Ä—ã–≤–∞–µ–º –µ—ë
                cardsContainer.style.overflowY = 'hidden';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏ –º—ã –º–∏–Ω–∏–º—É–º–∞
            const atMinSize = currentFontSize <= MIN_FONT_SIZE && 
                             currentPaddingTop <= MIN_PADDING && 
                             currentPaddingBottom <= MIN_PADDING &&
                             currentMinHeight <= MIN_HEIGHT &&
                             currentGap <= MIN_GAP;
            
            if (atMinSize) {
                // –î–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∏–Ω–∏–º—É–º - –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
                cardsContainer.style.overflowY = 'auto';
                return;
            }
            
            // –£–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫ (–Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ)
            // –¶–µ–ª—å: —Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–º–µ—â–∞—Ç—å—Å—è –≤ 3 —Å—Ç—Ä–æ–∫–∏, –Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–º
            // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞, —É–º–µ–Ω—å—à–∞–µ–º padding –∏ gap
            if (currentFontSize > MIN_FONT_SIZE) {
                // –£–º–µ–Ω—å—à–∞–µ–º —à—Ä–∏—Ñ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å
                currentFontSize = Math.max(MIN_FONT_SIZE, currentFontSize - 0.2);
            }
            // Padding —É–º–µ–Ω—å—à–∞–µ–º –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –º–µ—Å—Ç–∞ –ø–æ–¥ —Ç–µ–∫—Å—Ç
            if (currentPaddingTop > MIN_PADDING) {
                currentPaddingTop = Math.max(MIN_PADDING, currentPaddingTop - 0.3);
            }
            if (currentPaddingBottom > MIN_PADDING) {
                currentPaddingBottom = Math.max(MIN_PADDING, currentPaddingBottom - 0.3);
            }
            // –í—ã—Å–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–ª—è 3 —Å—Ç—Ä–æ–∫, –Ω–æ –Ω–µ –±–æ–ª—å—à–µ MAX_HEIGHT
            if (currentMinHeight > MAX_HEIGHT) {
                currentMinHeight = MAX_HEIGHT;
            } else if (currentMinHeight > MIN_HEIGHT) {
                // –í—ã—Å–æ—Ç—É —É–º–µ–Ω—å—à–∞–µ–º –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –ª—É—á—à–µ –∑–∞–ø–æ–ª–Ω—è–ª –∫–Ω–æ–ø–∫—É
                currentMinHeight = Math.max(MIN_HEIGHT, currentMinHeight - 0.2);
            }
            if (currentGap > MIN_GAP) {
                currentGap = Math.max(MIN_GAP, currentGap - 0.2);
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            const cards = cardsContainer.querySelectorAll('.ios-card');
            cards.forEach(card => {
                card.style.fontSize = currentFontSize + 'px';
                card.style.paddingTop = currentPaddingTop + 'px';
                card.style.paddingBottom = currentPaddingBottom + 'px';
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É
                card.style.minHeight = Math.min(currentMinHeight, MAX_HEIGHT) + 'px';
                card.style.maxHeight = MAX_HEIGHT + 'px';
            });
            
            const cardTitles = cardsContainer.querySelectorAll('.ios-card-title');
            cardTitles.forEach(title => {
                title.style.fontSize = currentFontSize + 'px';
            });
            
            cardsContainer.style.gap = currentGap + 'px';
            
            // –ñ–¥–µ–º –ø–µ—Ä–µ—Å—á–µ—Ç–∞ layout –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–Ω–æ–≤–∞
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    reduceSizes(iteration + 1);
                });
            });
        }
        
        // –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
        function adaptGroup() {
            // –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–∞ –ª–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤ –æ–¥–Ω–æ–∫–æ–ª–æ–Ω–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    if (!needsScroll()) {
                        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞ - –≤—Å—ë —Ö–æ—Ä–æ—à–æ
                        cardsContainer.style.overflowY = 'hidden';
                        revertToSingleColumn();
                        return;
                    }
                    
                    // –®–∞–≥ 2: –ü—Ä–æ–±—É–µ–º –¥–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π layout
                    applyTwoColumns();
                    
                    // –ñ–¥–µ–º –ø–µ—Ä–µ—Å—á–µ—Ç–∞ layout –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è grid
                    requestAnimationFrame(() => {
                        requestAnimationFrame(() => {
                            if (!needsScroll()) {
                                // –î–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π layout –ø–æ–º–æ–≥ - –≤—Å—ë —Ö–æ—Ä–æ—à–æ
                                cardsContainer.style.overflowY = 'hidden';
                                // –£–±—Ä–∞–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
                                // console.debug(`–ì—Ä—É–ø–ø–∞ "${group.querySelector('.ios-group-header')?.textContent}" —É–º–µ—Å—Ç–∏–ª–∞—Å—å –≤ –¥–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω–æ–º layout`);
                                return;
                            }
                            
                            // –®–∞–≥ 3: –î–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π layout –Ω–µ –ø–æ–º–æ–≥ - —É–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã
                            // –£–±—Ä–∞–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
                            // console.debug(`–ì—Ä—É–ø–ø–∞ "${group.querySelector('.ios-group-header')?.textContent}" —Ç—Ä–µ–±—É–µ—Ç —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤`);
                            reduceSizes();
                        });
                    });
                });
            });
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–¥–∞–ø—Ç–∞—Ü–∏—é
        adaptGroup();
    });
}

// === 1. –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ —Å–≤–µ—Ä—Ö—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞–Ω–µ–ª–µ–π ===
function adjustTopActions() {
    // –ï—Å–ª–∏ –≥—Ä—É–ø–ø –º–µ–Ω—å—à–µ 3 ‚Äî —Å—Ç–∞–≤–∏–º –∫–Ω–æ–ø–∫–∏ –æ–¥–Ω—É –ø–æ–¥ –æ–¥–Ω–æ–π (column), –∏–Ω–∞—á–µ –≤ —Ä—è–¥
    const groupsCount = document.querySelectorAll('.groups-container .ios-group').length;
    const actions = document.getElementById('top-actions');
    if (actions && groupsCount < 3) {
        actions.classList.add('stacked');
    } else if (actions) {
        actions.classList.remove('stacked');
    }
}
window.addEventListener('resize', adjustTopActions);

// === –ï–¥–∏–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ===
document.addEventListener('DOMContentLoaded', function () {
    // === 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –≤ ModalManager ===
    ModalManager.register('permission-modal');
    ModalManager.register('role-modal');
    ModalManager.register('scriptgen-modal');
    ModalManager.register('tn-modal');
    ModalManager.register('dep-modal');
    ModalManager.register('news-modal');
    ModalManager.register('reward-modal');
    ModalManager.register('profile-modal');
    
    // === 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≥—Ä—É–ø–ø ===
    loadAndRenderConfig();
    
    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    setTimeout(() => {
        adjustTopActions();
        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä—É–ø–ø –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ loadAndRenderConfig
    }, 100);
    
    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    let resizeTimeout;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
            adaptGroupsToFit();
            adjustTopActions();
        }, 150);
    });
    
    // === 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Å—ã–ª–æ–∫ –∏ —Å—Ç–∞—Ç—É—Å—ã ===
    // –ü—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å (–∑–µ–ª–µ–Ω—ã–π –∏–ª–∏ –∫—Ä–∞—Å–Ω—ã–π) –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–∏-—Å—Å—ã–ª–∫–∏
    function setStatus(card, isAvailable) {
    const title = card.querySelector('.ios-card-title');
    if (!title) return;
    if (isAvailable) {
        title.classList.remove('unavailable');
    } else {
        title.classList.add('unavailable');
    }
}

    // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ HEAD-–∑–∞–ø—Ä–æ—Å—É
    function checkCard(card) {
        const url = card.getAttribute('href');
        if (!url || url.startsWith('#') || url.startsWith('javascript')) return;
        if (!/^https?:\/\//i.test(url)) return;
        fetch(url, { method: 'HEAD', mode: 'no-cors' })
            .then(() => setStatus(card, true))
            .catch(() => setStatus(card, false));
    }
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–Ω–∏–º–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
    function checkAllCards() {
        const allCards = document.querySelectorAll('a.ios-card');
        allCards.forEach(checkCard);
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ (–¥–ª—è UX)
        const progressBar = safeQuerySelector('#progress-bar');
        if (progressBar) {
            progressBar.style.width = "0%";
            progressBar.style.display = "block";
            let width = 0;
            const interval = setInterval(() => {
                width += CONFIG.PROGRESS_BAR_ANIMATION_STEP;
                progressBar.style.width = width + "%";
                if (width >= 100) {
                    progressBar.style.display = "none";
                    clearInterval(interval);
                }
            }, CONFIG.PROGRESS_BAR_ANIMATION_INTERVAL);
        }
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    setTimeout(() => {
    checkAllCards();
        // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ 2 –º–∏–Ω—É—Ç—ã
        setInterval(checkAllCards, CONFIG.LINK_CHECK_INTERVAL);
    }, 500);

    // === 4. –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å –∫ body, –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞) ===
    const themeSwitcher = document.getElementById('theme-switcher');
    if (themeSwitcher) {
        themeSwitcher.addEventListener('change', function () {
            document.body.classList.toggle('dark-theme', this.checked);
            document.body.classList.toggle('light-theme', !this.checked);
        });
    }

    // === 5. –ú–æ–¥–∞–ª–∫–∞ Permission ===
    const permissionModal = safeQuerySelector('#permission-modal');
    const closePermissionBtn = safeQuerySelector('#close-btn');
    const clearPermissionBtn = safeQuerySelector('#clear-btn');
    const decodeBtn = safeQuerySelector('#decode-btn');
    const permissionInput = safeQuerySelector('#permission-input');
    const permissionResult = safeQuerySelector('#permission-result');
    if (closePermissionBtn) {
        closePermissionBtn.onclick = function () {
            permissionModal.classList.remove('show');
        };
    }
    if (clearPermissionBtn) {
        clearPermissionBtn.onclick = function () {
            permissionInput.value = '';
            permissionInput.focus();
            permissionResult.textContent = '';
        };
    }
    if (decodeBtn) {
        decodeBtn.onclick = function () {
            // –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è HEX-–ø—Ä–∞–≤–∞ –≤ –±–∏—Ç—ã
            const input = permissionInput.value.trim();
            if (!input) {
                permissionResult.textContent = '';
                return;
            }
            try {
                let hex = input.split(",")
                    .reverse()
                    .map(s => s.replace(/[""]/g, ' '))
                    .map(s => s.trim())
                    .map(s => Number.parseInt(s, 16))
                    .map(n => n.toString(2))
                    .map(s => s.padStart(32, "0"));
                const zeroOnes = hex
                    .join("").split("").reverse().join("");
                const res = [];
                for (let i = 0; i < zeroOnes.length; i++) {
                    if (zeroOnes[i] == "1") {
                        res.push(i);
                    }
                }
                permissionResult.textContent = '–ë–∏–Ω–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ:\n' +
                    zeroOnes.split('').map((b, idx) => ((idx % 8 === 0 && idx > 0) ? ' ' : '') + b).join('') +
                    '\n\n–í–∫–ª—é—á—ë–Ω–Ω—ã–µ –±–∏—Ç—ã:\n' + res.join(', ');
            } catch (err) {
                permissionResult.textContent = '–û—à–∏–±–∫–∞! –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥.';
            }
        };
    }
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –∫–ª–∏–∫–æ–º –≤–Ω–µ –æ–∫–Ω–∞
    window.addEventListener('click', function (e) {
        if (e.target === permissionModal) {
            permissionModal.classList.remove('show');
        }
    });
    });

    // === 6. –ú–æ–¥–∞–ª–∫–∞ —Ä–æ–ª–∏ ===
    const roleModal = safeQuerySelector('#role-modal');
    const closeRoleModalBtn = safeQuerySelector('#close-role-modal');
    const openRoleLinkBtn = safeQuerySelector('#open-role-link');
    const empInput = safeQuerySelector('#employee-number');
    const roleInput = safeQuerySelector('#role-name');
    const clearEmpBtn = safeQuerySelector('#clear-emp-btn');
    const clearRoleBtn = safeQuerySelector('#clear-role-btn');
    const defaultBtn = safeQuerySelector('#default-btn');

    // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ "–û—Ç–∫—Ä—ã—Ç—å" –µ—Å–ª–∏ –æ–±–∞ –ø–æ–ª—è –Ω–µ –ø—É—Å—Ç—ã–µ
    function checkRoleInputs() {
        if (openRoleLinkBtn && empInput && roleInput) {
        openRoleLinkBtn.disabled = !(empInput.value.trim() && roleInput.value.trim());
    }
    }
    if (closeRoleModalBtn) {
        closeRoleModalBtn.onclick = function () {
            roleModal.classList.remove('show');
        };
    }
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –∫–ª–∏–∫–æ–º –≤–Ω–µ –æ–∫–Ω–∞ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ ModalManager)
    if(empInput) empInput.addEventListener('input', checkRoleInputs);
    if(roleInput) roleInput.addEventListener('input', checkRoleInputs);
    if(clearEmpBtn) clearEmpBtn.onclick = function() {
        empInput.value = '';
        empInput.focus();
        checkRoleInputs();
    };
    if(clearRoleBtn) clearRoleBtn.onclick = function() {
        roleInput.value = '';
        roleInput.focus();
        checkRoleInputs();
    };
    if(openRoleLinkBtn) openRoleLinkBtn.onclick = function() {
        // –§–æ—Ä–º–∏—Ä—É–µ–º url –ø–æ —à–∞–±–ª–æ–Ω—É –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
        const emp = encodeURIComponent(empInput.value.trim());
        const role = encodeURIComponent(roleInput.value.trim());
        const url = `https://iam-enigma-psi.omega.sbrf.ru/rmkib.support/api/v1/service/auth/explain/html?employee-number=${emp}&role=${role}`;
        window.open(url, '_blank');
    };
    if(defaultBtn) {
        defaultBtn.onclick = function() {
            empInput.value = '673892';
            roleInput.value = 'EFS_NB_SUP_BUSINESS_ADMIN_GAMIFICATION';
            empInput.focus();
            checkRoleInputs();
        };
    }

    // === 7. –≠–∫—Å–ø–æ—Ä—Ç —Å—Å—ã–ª–æ–∫ –≤ CSV ===

// ====== –ú–æ–¥–∞–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–∫—Ä–∏–ø—Ç–∞ SalesHeroes (–µ–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å) ======
const scriptgenModal = safeQuerySelector('#scriptgen-modal');
const closeScriptgenModalBtn = safeQuerySelector('#close-scriptgen-modal');
const sgResult = safeQuerySelector('#sg-result');
const sgCopyBtn = safeQuerySelector('#sg-copy-btn');
// --- ScriptGen: –ö–Ω–æ–ø–∫–∏ "–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é" –∏ "–û—á–∏—Å—Ç–∏—Ç—å" ---
const sgTournamentIds = safeQuerySelector('#sg-tournamentIds');
const sgServiceName = safeQuerySelector('#sg-serviceName');
const sgUrlAlpha = safeQuerySelector('#sg-urlAlpha');
const sgUrlSigma = safeQuerySelector('#sg-urlSigma');
const sgApiPath = safeQuerySelector('#sg-apiPath');
const sgDefaultBtn = safeQuerySelector('#sg-default-btn');
const sgClearBtn = safeQuerySelector('#sg-clear-btn');

// –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–º–µ–Ω—è–π—Ç–µ –∑–¥–µ—Å—å, –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥—Ä—É–≥–æ–µ)
// –ù–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
const defaultTournamentIds = 't_01_2025-1_05-1_1_3051, t_01_2025-1_05-1_1_3041'; // —Ç–µ–ø–µ—Ä—å –ª—é–±—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
const defaultServiceName = 'leadersForAdmin';
const defaultUrlAlpha = 'https://efs-our-business-prom.omega.sbrf.ru';
const defaultUrlSigma = 'https://salesheroes.sberbank.ru';
const defaultApiPath = '/bo/rmkib.gamification/api/v1/tournaments/';

if (sgDefaultBtn) sgDefaultBtn.onclick = function () {
    sgTournamentIds.value = defaultTournamentIds;
    sgServiceName.value = defaultServiceName;
    sgUrlAlpha.value = defaultUrlAlpha;
    sgUrlSigma.value = defaultUrlSigma;
    sgApiPath.value = defaultApiPath;    // –ù–æ–≤–æ–µ –ø–æ–ª–µ!
    sgResult.value = '';
    sgTournamentIds.focus();
};

// "–û—á–∏—Å—Ç–∏—Ç—å" ‚Äî –æ—á–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ Tournament IDs –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if (sgClearBtn) sgClearBtn.onclick = function () {
    sgTournamentIds.value = '';
    sgResult.value = '';
    sgTournamentIds.focus();
};

// –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É (–æ—Ç–∫—Ä—ã—Ç–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ initDynamicEventHandlers)
if (closeScriptgenModalBtn) {
closeScriptgenModalBtn.onclick = function() {
        if (scriptgenModal) {
    scriptgenModal.classList.remove('show');
        }
};
}
// –ö–ª–∏–∫ –≤–Ω–µ –æ–∫–Ω–∞ ‚Äî –∑–∞–∫—Ä—ã—Ç—å
window.addEventListener('click', function(e) {
    if (e.target === scriptgenModal) scriptgenModal.classList.remove('show');
});
// –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä
if (sgCopyBtn) {
sgCopyBtn.onclick = function() {
        if (sgResult && sgResult.value) {
            copyToClipboard(sgResult.value, sgCopyBtn);
        }
    };
}

// –í–∞–ª–∏–¥–∞—Ü–∏—è Tournament IDs
function validateTournamentIds(input) {
    const ids = input.split(/[^a-zA-Z0-9\-_]+/g)
        .map(s => s.trim())
        .filter(Boolean);
    
    if (ids.length === 0) {
        throw new Error('–ù–µ —É–∫–∞–∑–∞–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ Tournament ID');
    }
    
    return ids;
}

function generateScriptSber(type) {
    try {
        const tournamentIdsInput = safeQuerySelector('#sg-tournamentIds');
        const serviceNameInput = safeQuerySelector('#sg-serviceName');
        const urlAlphaInput = safeQuerySelector('#sg-urlAlpha');
        const urlSigmaInput = safeQuerySelector('#sg-urlSigma');
        const apiPathInput = safeQuerySelector('#sg-apiPath');
        const sgResult = safeQuerySelector('#sg-result');
        
        if (!tournamentIdsInput || !serviceNameInput || !urlAlphaInput || !urlSigmaInput || !apiPathInput || !sgResult) {
            Logger.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞');
            return;
        }
        
        const ids = validateTournamentIds(tournamentIdsInput.value);
        const service = serviceNameInput.value.trim();
        const urlAlpha = urlAlphaInput.value.trim();
        const urlSigma = urlSigmaInput.value.trim();
        const apiPath = apiPathInput.value.trim();
        
        if (!service || !urlAlpha || !urlSigma || !apiPath) {
            Logger.error('–ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
            return;
        }
        
    const baseUrl = (type === 'alpha' ? urlAlpha : urlSigma) + apiPath;

    let code = `// ==UserScript==\n`;
    code += `// –°–∫—Ä–∏–ø—Ç –¥–ª—è DevTools. –í—ã–≥—Ä—É–∑–∫–∞ –ª–∏–¥–µ—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö Tournament ID (–æ–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä)\n`;
    code += `(async () => {\n`;
    code += `  // === –£–¥–∞–ª–µ–Ω–∏–µ photoData —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ ===\n`;
    code += `  function removePhotoData(obj) {\n`;
    code += `    if (Array.isArray(obj)) {\n`;
    code += `      obj.forEach(removePhotoData);\n`;
    code += `    } else if (obj && typeof obj === 'object') {\n`;
    code += `      Object.keys(obj).forEach(key => {\n`;
    code += `        if (key === 'photoData') {\n`;
    code += `          delete obj[key];\n`;
    code += `        } else {\n`;
    code += `          removePhotoData(obj[key]);\n`;
    code += `        }\n`;
    code += `      });\n`;
    code += `    }\n`;
    code += `  }\n\n`;

    code += `  // === –ì–µ–Ω–µ—Ä–∞—Ü–∏—è timestamp ===\n`;
    code += `  function getTimestamp() {\n`;
    code += `    const d = new Date();\n`;
    code += `    const pad = n => n.toString().padStart(2, '0');\n`;
    code += `    return d.getFullYear().toString()\n`;
    code += `      + pad(d.getMonth() + 1)\n`;
    code += `      + pad(d.getDate())\n`;
    code += `      + '-' + pad(d.getHours())\n`;
    code += `      + pad(d.getMinutes())\n`;
    code += `      + pad(d.getSeconds());\n`;
    code += `  }\n\n`;

    code += `  const ids = ${JSON.stringify(ids)};\n`;
    code += `  const service = ${JSON.stringify(service)};\n`;
    code += `  const BASE_URL = ${JSON.stringify(baseUrl)};\n`;
    code += `  const results = {};\n`;
    code += `  let processed = 0, skipped = 0, errors = 0;\n`;
    code += `  console.log('‚ñ∂Ô∏è –í—Å–µ–≥–æ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ:', ids.length, '–∫–æ–¥(–æ–≤)');\n\n`;

    code += `  for (let i = 0; i < ids.length; ++i) {\n`;
    code += `    const tid = ids[i];\n`;
    code += `    const url = BASE_URL + tid + '/' + service + '?pageNum=1';\n`;
    code += `    console.log(\`‚è≥ [\${i+1}/\${ids.length}] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–¥: \${tid}\`);\n`;
    code += `    let resp, data;\n`;
    code += `    try {\n`;
    code += `      resp = await fetch(url, {\n`;
    code += `        headers: { 'Accept': 'application/json', 'Cookie': document.cookie }, credentials: 'include'\n`;
    code += `      });\n`;
    code += `      if (!resp.ok) {\n`;
    code += `        console.warn(\`‚ùå [\${i+1}/\${ids.length}] –ö–æ–¥ \${tid}: HTTP —Å—Ç–∞—Ç—É—Å \${resp.status}\`);\n`;
    code += `        errors++;\n`;
    code += `        continue;\n`;
    code += `      }\n`;
    code += `      data = await resp.json();\n`;
    code += `      // –ß–∏—Å–ª–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n`;
    code += `      let leadersCount = 0;\n`;
    code += `      try {\n`;
    code += `        const leadersArr = data?.body?.tournament?.leaders || data?.body?.badge?.leaders;\n`;
    code += `        if (Array.isArray(leadersArr)) {\n`;
    code += `          leadersCount = leadersArr.length;\n`;
    code += `        }\n`;
    code += `      } catch {}\n`;
    code += `      if (leadersCount === 0) {\n`;
    code += `        console.log(\`‚ÑπÔ∏è [\${i+1}/\${ids.length}] –ö–æ–¥ \${tid} –ø—Ä–æ–ø—É—â–µ–Ω: —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ = 0\`);\n`;
    code += `        skipped++;\n`;
    code += `        continue;\n`;
    code += `      }\n`;
    code += `      console.log(\`‚úÖ [\${i+1}/\${ids.length}] –ö–æ–¥ \${tid}: —É—Å–ø–µ—à–Ω–æ, —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: \${leadersCount}\`);\n`;
    code += `      results[tid] = [data];\n`;
    code += `      processed++;\n`;
      code += `      await new Promise(r => setTimeout(r, ${CONFIG.PROFILE_REQUEST_DELAY}));\n`;
    code += `    } catch (e) {\n`;
    code += `      console.error(\`‚ùå [\${i+1}/\${ids.length}] –ö–æ–¥ \${tid}: –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:\`, e);\n`;
    code += `      errors++;\n`;
    code += `    }\n`;
    code += `  }\n\n`;

    code += `  console.log('üßπ –£–¥–∞–ª—è–µ–º –≤—Å–µ –ø–æ–ª—è photoData');\n`;
    code += `  removePhotoData(results);\n\n`;

    code += `  console.log('üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª ...');\n`;
    code += `  const ts = getTimestamp();\n`;
    code += `  const blob = new Blob([JSON.stringify(results, null, 2)], {type: 'application/json'});\n`;
    code += `  const a = document.createElement('a');\n`;
    code += `  a.href = URL.createObjectURL(blob);\n`;
    code += `  a.download = service + '_ALL_' + ts + '.json';\n`;
    code += `  document.body.appendChild(a);\n`;
    code += `  a.click();\n`;
    code += `  a.remove();\n`;
    code += `  console.log(\`üèÅ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å–µ–≥–æ: \${ids.length}. –£—Å–ø–µ—à–Ω–æ: \${processed}. –ü—Ä–æ–ø—É—â–µ–Ω–æ: \${skipped}. –û—à–∏–±–æ–∫: \${errors}. –§–∞–π–ª —Å–∫–∞—á–∞–Ω.\`);\n`;
    code += `})();\n`;

    sgResult.value = code;
        Logger.info('–°–∫—Ä–∏–ø—Ç —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω', { type, idsCount: ids.length });
    } catch (error) {
        Logger.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞', error);
        const sgResult = safeQuerySelector('#sg-result');
        if (sgResult) {
            sgResult.value = `// –û—à–∏–±–∫–∞: ${error.message}`;
        }
    }
}




// ====== 5-—è –∏ 6-—è –º–æ–¥–∞–ª–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è addressBook ======

// --- –¢–ù ---
const tnModal = document.getElementById('tn-modal');
const openTnModalBtn = document.getElementById('open-tn-modal-link');
const tnCloseBtn = document.getElementById('tn-close-btn');
const tnGenBtn = document.getElementById('tn-gen-btn');
const tnCopyBtn = document.getElementById('tn-copy-btn');
const tnInput = document.getElementById('tn_input');
const outTn = document.getElementById('out_tn');

tnCloseBtn.onclick = function() { tnModal.classList.remove('show'); };
window.addEventListener('click', e => { if (e.target === tnModal) tnModal.classList.remove('show'); });

tnGenBtn.onclick = function() {
  let input = tnInput.value;
  let tnList = input.split(/\D+/).map(x => x.trim()).filter(x => x.length > 0).map(x => x.padStart(8, '0'));
  if (tnList.length === 0) {
    outTn.value = '// –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ç–∞–±–µ–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞.';
    return;
  }
  let js = `
/**
 * –°–∫—Ä–∏–ø—Ç –¥–ª—è DevTools addressBook (–ø–æ –¢–ù)
 * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –≤ –æ–¥–∏–Ω JSON-—Ñ–∞–π–ª
 * GET /api/home/empInfoFull?empId=<tn>
 */
(async () => {
  const tnList = ${JSON.stringify(tnList, null, 2)};
  const results = [];
  for (let i = 0; i < tnList.length; ++i) {
    const tn = tnList[i];
    try {
      const resp = await fetch('/api/home/empInfoFull?empId=' + tn, {
        method: 'GET',
        credentials: 'same-origin'
      });
      if (resp.ok) {
        results.push({ tn, data: await resp.json() });
        console.log('[' + (i+1) + '/' + tnList.length + '] OK', tn);
      } else {
        results.push({ tn, error: 'HTTP ' + resp.status });
        console.log('[' + (i+1) + '/' + tnList.length + '] –û—à–∏–±–∫–∞ HTTP ' + resp.status, tn);
      }
    } catch (e) {
      results.push({ tn, error: String(e) });
      console.log('[' + (i+1) + '/' + tnList.length + '] –û—à–∏–±–∫–∞ —Å–µ—Ç–∏', tn, e);
    }
    if (i < tnList.length - 1) await new Promise(r => setTimeout(r, 10));
  }
  // –°–∫–∞—á–∞—Ç—å JSON-—Ñ–∞–π–ª:
  const blob = new Blob([JSON.stringify(results, null, 2)], {type: 'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'empInfoFull_results.json';
  a.click();
  console.log('–ì–æ—Ç–æ–≤–æ. –§–∞–π–ª –≤—ã–≥—Ä—É–∂–µ–Ω.');
})();`.trim();
  outTn.value = js;
};

if (tnCopyBtn) {
tnCopyBtn.onclick = function() {
        if (outTn && outTn.value) {
            copyToClipboard(outTn.value, tnCopyBtn);
        }
    };
}


// --- –ö–û–î–´ –ü–û–î–†–ê–ó–î–ï–õ–ï–ù–ò–ô ---
const depModal = document.getElementById('dep-modal');
const openDepModalBtn = document.getElementById('open-dep-modal-link');
const depCloseBtn = document.getElementById('dep-close-btn');
const depGenBtn = document.getElementById('dep-gen-btn');
const depCopyBtn = document.getElementById('dep-copy-btn');
const depInput = document.getElementById('dep_input');
const outDep = document.getElementById('out_dep');

if (openDepModalBtn) {
openDepModalBtn.onclick = function() {
  depModal.classList.add('show');
  outDep.value = '';
  depInput.value = '';
  depInput.focus();
};
}
depCloseBtn.onclick = function() { depModal.classList.remove('show'); };
window.addEventListener('click', e => { if (e.target === depModal) depModal.classList.remove('show'); });

depGenBtn.onclick = function() {
  let input = depInput.value;
  let depList = input.split(/\D+/).map(x => x.trim()).filter(x => x.length > 0);
  if (depList.length === 0) {
    outDep.value = '// –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è.';
    return;
  }
  let js = `
/**
 * –°–∫—Ä–∏–ø—Ç –¥–ª—è DevTools addressBook (–ø–æ –∫–æ–¥—É –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è)
 * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –≤ –æ–¥–∏–Ω JSON-—Ñ–∞–π–ª
 * POST /api/home/departments/<–∫–æ–¥>/employees:search
 */
(async () => {
  const depList = ${JSON.stringify(depList, null, 2)};
  const results = [];
  for (let i = 0; i < depList.length; ++i) {
    const depCode = depList[i];
    try {
      const resp = await fetch('/api/home/departments/' + depCode + '/employees:search', {
        method: 'POST',
        credentials: 'same-origin',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          "sortField": "displayName",
          "sortDirection": "ASC",
          "activeOnly": true,
          "page": 0,
          "size": 9999
        })
      });
      if (resp.ok) {
        results.push({ depCode, data: await resp.json() });
        console.log('[' + (i+1) + '/' + depList.length + '] OK', depCode);
      } else {
        results.push({ depCode, error: 'HTTP ' + resp.status });
        console.log('[' + (i+1) + '/' + depList.length + '] –û—à–∏–±–∫–∞ HTTP ' + resp.status, depCode);
      }
    } catch (e) {
      results.push({ depCode, error: String(e) });
      console.log('[' + (i+1) + '/' + depList.length + '] –û—à–∏–±–∫–∞ —Å–µ—Ç–∏', depCode, e);
    }
    if (i < depList.length - 1) await new Promise(r => setTimeout(r, 1000));
  }
  // –°–∫–∞—á–∞—Ç—å JSON-—Ñ–∞–π–ª:
  const blob = new Blob([JSON.stringify(results, null, 2)], {type: 'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'departments_employees_results.json';
  a.click();
  console.log('–ì–æ—Ç–æ–≤–æ. –§–∞–π–ª –≤—ã–≥—Ä—É–∂–µ–Ω.');
})();`.trim();
  outDep.value = js;
};

if (depCopyBtn) {
depCopyBtn.onclick = function() {
        if (outDep && outDep.value) {
            copyToClipboard(outDep.value, depCopyBtn);
        }
    };
}



// –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π (–æ–±—â–∞—è –¥–ª—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
function generateNewsScript(env) {
  const raw = document.getElementById('news_input').value;
  const output = document.getElementById('news-output');

  const codes = raw
    .split(/[^0-9]+/)
    .map(x => x.trim())
    .filter(x => /^\d{10,}$/.test(x));

  if (codes.length === 0) {
    output.value = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–¥—ã –Ω–æ–≤–æ—Å—Ç–µ–π';
    return;
  }

  const baseURL = env === 'alpha'
    ? 'https://efs-our-business-prom.omega.sbrf.ru/bo/rmkib.gamification/api/v1/news/'
    : 'https://salesheroes.sberbank.ru/bo/rmkib.gamification/api/v1/news/';

  let script = `(async function() {\n`;
  script += `  const delay = ms => new Promise(r => setTimeout(r, ms));\n`;
  script += `  const results = [];\n`;
  script += `  const headers = {\n`;
  script += `    'accept': '*/*',\n`;
  script += `    'accept-encoding': 'gzip, deflate, br, zstd',\n`;
  script += `    'accept-language': 'ru-RU,ru;q=0.9',\n`;
  script += `    'cache-control': 'no-cache',\n`;
  script += `    'cookie': document.cookie\n`;
  script += `  };\n`;
  script += `  const news = [\n    '` + codes.join(`',\n    '`) + `'\n  ];\n`;
  script += `  for (let i = 0; i < news.length; i++) {\n`;
  script += `    try {\n`;
  script += `      const res = await fetch('${baseURL}' + news[i], { headers });\n`;
  script += `      if (res.ok) results.push(await res.json());\n`;
  script += `      else console.warn('–û—à–∏–±–∫–∞ –ø–æ', news[i]);\n`;
  script += `    } catch (e) {\n`;
  script += `      console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ', news[i], e);\n`;
  script += `    }\n`;
  script += `    await delay(1000);\n`;
  script += `  }\n`;
  script += `  const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });\n`;
  script += `  const a = document.createElement('a');\n`;
  script += `  a.href = URL.createObjectURL(blob);\n`;
  script += `  a.download = 'news_dump.json';\n`;
  script += `  a.click();\n`;
  script += `})();\n`;

  output.value = script;
  document.getElementById('news-copy-btn').disabled = false;
}

    // === 8. –ú–æ–¥–∞–ª–∫–∞ News (–í—ã–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–∫–∏ –ø–æ –Ω–æ–≤–æ—Å—Ç—è–º) ===
    const newsBtn = safeQuerySelector('#open-news-modal-link');
    const newsModal = safeQuerySelector('#news-modal');
    const newsCloseBtn = safeQuerySelector('#news-close-btn');
    const newsClearBtn = safeQuerySelector('#news-clear-btn');
    const newsDefaultBtn = safeQuerySelector('#news-default-btn');
    const newsCopyBtn = safeQuerySelector('#news-copy-btn');
    const newsInput = safeQuerySelector('#news_input');
    const newsOutput = safeQuerySelector('#news-output');

    if (newsBtn && newsModal) {
  newsBtn.addEventListener('click', () => newsModal.classList.add('show'));
    }

    if (newsCloseBtn) {
        newsCloseBtn.addEventListener('click', () => {
            if (newsInput) newsInput.value = '';
            if (newsOutput) newsOutput.value = '';
            if (newsCopyBtn) newsCopyBtn.disabled = true;
            if (newsModal) newsModal.classList.remove('show');
        });
    }

    if (newsClearBtn && newsInput) {
        newsClearBtn.addEventListener('click', () => {
            newsInput.value = '';
            newsInput.focus();
            if (newsOutput) newsOutput.value = '';
            if (newsCopyBtn) newsCopyBtn.disabled = true;
        });
    }

    if (newsDefaultBtn) {
        newsDefaultBtn.addEventListener('click', () => {
            if (newsInput) newsInput.value = '715429170081770418; 715429169708477428';
            if (newsOutput) newsOutput.value = '';
            if (newsCopyBtn) newsCopyBtn.disabled = true;
        });
    }

    if (newsCopyBtn && newsOutput) {
        newsCopyBtn.addEventListener('click', () => {
            if (newsOutput.value) {
                copyToClipboard(newsOutput.value, newsCopyBtn);
            }
        });
  }

  ['alpha', 'sigma'].forEach(env => {
        const btn = safeQuerySelector(`#news-${env}-btn`);
        if (btn) {
            btn.addEventListener('click', () => generateNewsScript(env));
        }
    });

    // === 9. –ú–æ–¥–∞–ª–∫–∞ Reward (–í—ã–≥—Ä—É–∑–∫–∞ –ø–æ –Ω–∞–≥—Ä–∞–¥–∞–º) ===
    const rewardModal = safeQuerySelector('#reward-modal');
    const openRewardModalBtn = safeQuerySelector('#open-reward-modal-link');
    const closeRewardModalBtn = safeQuerySelector('#reward-close-btn');
    const clearBtn = safeQuerySelector('#reward-clear-btn');
    const copyBtn = safeQuerySelector('#reward-copy-btn');
    const rewardDefaultBtn = safeQuerySelector('#reward-default-btn');
    const rewardInput = safeQuerySelector('#reward-input');
    const rewardOutput = safeQuerySelector('#reward-result');
    const alphaBtn = safeQuerySelector('#reward-alpha-btn');
    const sigmaBtn = safeQuerySelector('#reward-sigma-btn');

  // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É
    if (openRewardModalBtn && rewardModal) {
        openRewardModalBtn.addEventListener('click', function () {
      rewardModal.classList.add('show');
            if (rewardInput) rewardInput.focus();
            if (rewardOutput) rewardOutput.value = '';
            if (copyBtn) copyBtn.disabled = true;
        });
  }

  // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É
    if (closeRewardModalBtn && rewardModal) {
        closeRewardModalBtn.addEventListener('click', function () {
      rewardModal.classList.remove('show');
            if (rewardInput) rewardInput.value = '';
            if (rewardOutput) rewardOutput.value = '';
            if (copyBtn) copyBtn.disabled = true;
        });
  }

  // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
  if (clearBtn) {
        clearBtn.addEventListener('click', function () {
            if (rewardInput) rewardInput.value = '';
            if (rewardOutput) rewardOutput.value = '';
            if (copyBtn) copyBtn.disabled = true;
            if (rewardInput) rewardInput.focus();
        });
  }

    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
    if (rewardDefaultBtn && rewardInput) {
        rewardDefaultBtn.addEventListener('click', function () {
            rewardInput.value = 'r_01_2025-0_10-1_2; r_01_2025-0_10-1_1';
            if (rewardOutput) rewardOutput.value = '';
            if (copyBtn) copyBtn.disabled = true;
            rewardInput.focus();
        });
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è Alpha/Sigma
function buildRewardScript({codes, baseUrl, cookie}) {
  return `// ==UserScript==
// DevTools: –≤—ã–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–¥–∞ REWARD
(() => {
  const CODES = \`${codes.join(';')}\`.split(/[ ,;\\n]+/).filter(Boolean);
  const BASE_URL = '${baseUrl}';
  const COOKIE = '${cookie}';
  const DELAY_MS = 1000;

  const sleep = ms => new Promise(r => setTimeout(r, ms));
  async function fetchPage(code, page) {
    const url = \`\${BASE_URL}\${code}/profiles?pageNum=\${page}&divisionLevel=BANK\`;
    return fetch(url, {
      headers: {
        'accept': 'application/json',
        'content-type': 'application/json',
        'cookie': COOKIE
      },
      credentials: 'include'
    }).then(r => r.json());
  }

  async function main() {
    const results = {};
    for (const code of CODES) {
      console.log(\`‚ñ∂Ô∏è –ù–∞—á–∏–Ω–∞—é –≤—ã–≥—Ä—É–∑–∫—É –ø–æ –∫–æ–¥—É: \${code}\`);
      const first = await fetchPage(code, 1);
      results[code] = [first];
      // –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–æ—Å—Ç–∞—ë–º –ø–æ–ª–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤!
      let total = 0;
      if (first && first.body && first.body.badge && first.body.badge.contestants) {
        let cnt = first.body.badge.contestants;
        if (typeof cnt === "string") {
          let match = cnt.match(/(\\d+)/);
          if (match) total = parseInt(match[1], 10);
        } else if (typeof cnt === "number") {
          total = cnt;
        }
      }
      let pages = Math.ceil(total / 100);
      console.log(\`  ‚ÑπÔ∏è –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–∏–∑ –ø–æ–ª—è body.badge.contestants): \${total}\`);
      console.log(\`  ‚ÑπÔ∏è –í—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏: \${pages}\`);
      for (let page = 2; page <= pages; page++) {
        console.log(\`    ‚è≥ –ó–∞–ø—Ä–∞—à–∏–≤–∞—é —Å—Ç—Ä–∞–Ω–∏—Ü—É \${page} –∏–∑ \${pages}\`);
        await sleep(DELAY_MS);
        const data = await fetchPage(code, page);
        results[code].push(data);
        console.log(\`    ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ \${page} –∏–∑ \${pages}\`);
      }
      await sleep(DELAY_MS);
    }
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    const blob = new Blob([JSON.stringify(results, null, 2)], {type: 'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'rewards_result.json';
    a.click();
    console.log('‚úÖ –í—ã–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
  }

  main();
})();`;
}



  const REWARD_COOKIE = ''; // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–π cookie

  // –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Alpha
    if (alphaBtn && rewardInput && rewardOutput) {
        alphaBtn.addEventListener('click', function () {
            const codes = rewardInput.value.split(/[ ,;\n]+/).filter(Boolean);
            rewardOutput.value = buildRewardScript({
        codes,
        baseUrl: 'https://efs-our-business-prom.omega.sbrf.ru/bo/rmkib.gamification/api/v1/badges/',
        cookie: REWARD_COOKIE
      });
            if (copyBtn) copyBtn.disabled = false;
        });
  }

  // –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Sigma
    if (sigmaBtn && rewardInput && rewardOutput) {
        sigmaBtn.addEventListener('click', function () {
            const codes = rewardInput.value.split(/[ ,;\n]+/).filter(Boolean);
            rewardOutput.value = buildRewardScript({
        codes,
        baseUrl: 'https://salesheroes.sberbank.ru/bo/rmkib.gamification/api/v1/badges/',
        cookie: REWARD_COOKIE
      });
            if (copyBtn) copyBtn.disabled = false;
        });
  }

  // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    if (copyBtn && rewardOutput) {
        copyBtn.addEventListener('click', function () {
            if (rewardOutput.value) {
                copyToClipboard(rewardOutput.value, copyBtn);
            }
        });
    }

    // –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–≤–æ–¥–∞
    if (rewardInput && rewardOutput) {
        rewardInput.addEventListener('input', function () {
            rewardOutput.value = '';
            if (copyBtn) copyBtn.disabled = true;
        });
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ ModalManager)
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–æ–¥–∞ —Ç–µ–ø–µ—Ä—å –≤ initDynamicEventHandlers()
});
</script>

<script>
function openProfileModal() {
    document.getElementById('profile-modal').classList.add('show');
    document.getElementById('profile-input').focus();
}
function closeProfileModal() {
    document.getElementById('profile-modal').classList.remove('show');
}
